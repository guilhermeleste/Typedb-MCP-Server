---
applyTo: "tests/**"
---

# Testing Instructions

## Test Naming & Organization
- Test functions use `test_` prefix
- Helper functions use `helper_` prefix and are located in `tests/common/`
- Integration tests go in `tests/integration/`
- Test files follow the pattern `{module_name}_tests.rs`

## Test Categories
- **Unit Tests**: Test individual functions and modules in isolation
- **Integration Tests**: Test MCP tool workflows end-to-end
- **Error Tests**: Verify all error conditions and edge cases
- **Security Tests**: Validate authentication and authorization flows

## Test Data & Fixtures
- Use mock data from `tests/resources/`
- Create realistic TypeDB test schemas and data
- Use Docker containers for integration testing
- Clean up test data after each test

## Testing Patterns
```rust
#[tokio::test]
async fn test_function_success() {
    // Arrange
    let test_data = helper_create_test_data();
    
    // Act
    let result = function_under_test(test_data).await;
    
    // Assert
    assert!(result.is_ok());
}
```

## MCP Testing
- Test JSON-RPC message handling
- Validate tool parameter processing  
- Test authentication flows with mock JWT tokens
- Verify error response formats

## Test Utilities
- Use `helper_setup_test_environment()` for Docker setup
- Use `helper_create_jwt_token()` for auth testing
- Use `helper_assert_mcp_response()` for response validation
- Use `helper_typedb_test_data()` for sample data

## Test Coverage
- Aim for comprehensive coverage of public APIs
- Test all error paths explicitly
- Verify resource cleanup and proper async cancellation
- Test configuration edge cases and environment variations
